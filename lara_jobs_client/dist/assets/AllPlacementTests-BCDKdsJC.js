import{r as a,b as A,c as M,V as d,j as e,h as g}from"./index-CVcFn3UJ.js";import{g as k,u as U,t as O,a as D}from"./placementTest-bJn3Zzhd.js";function I({title:r,titleId:i,...u},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":i},u),r?a.createElement("title",{id:i},r):null,a.createElement("path",{fillRule:"evenodd",d:"M13.887 3.182c.396.037.79.08 1.183.128C16.194 3.45 17 4.414 17 5.517V16.75A2.25 2.25 0 0 1 14.75 19h-9.5A2.25 2.25 0 0 1 3 16.75V5.517c0-1.103.806-2.068 1.93-2.207.393-.048.787-.09 1.183-.128A3.001 3.001 0 0 1 9 1h2c1.373 0 2.531.923 2.887 2.182ZM7.5 4A1.5 1.5 0 0 1 9 2.5h2A1.5 1.5 0 0 1 12.5 4v.5h-5V4Z",clipRule:"evenodd"}))}const V=a.forwardRef(I);function B({title:r,titleId:i,...u},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":i},u),r?a.createElement("title",{id:i},r):null,a.createElement("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"}))}const Z=a.forwardRef(B),z=({placement_test_id:r,show:i,handleClose:u})=>{const[n,b]=a.useState({test_id:r,number_of_questions:"",description:"",start_time:"",end_time:"",show_result:!0,is_Monitored:!1,topic_ids:[],test_title:"",certificate_name:"",issue_certificate:!1}),[T,j]=a.useState([]);a.useEffect(()=>{r&&i&&f()},[r,i]);const f=async()=>{try{const c=await A.get(`${M}/api/placement-test/test/test-link/${r}`),s=c.data.data;console.log("Response test data : ",c),b({number_of_questions:s.number_of_questions,description:s.description,start_time:s.start_time,end_time:s.end_time,show_result:s.show_result,is_Monitored:s.is_Monitored,topic_ids:Array.isArray(s.placementTestTopics)?s.placementTestTopics.map(x=>x.topic_id):[],test_title:s.test_title,certificate_name:s.certificate_name,issue_certificate:s.issue_certificate}),j(Array.isArray(s.topics)?s.topics:[])}catch(c){d.error("Failed to fetch test details"),console.error("Error fetching test details:",c)}},h=async c=>{c.preventDefault();try{const s=localStorage.getItem("token");if(!s)throw new Error("No token provided.");const x={headers:{Authorization:`Bearer ${s}`}};await A.put(`${M}/api/placement-test/test/test-link/update/${r}`,n,x),d.success("Placement test updated successfully!"),u()}catch(s){d.error("Failed to update placement test"),console.error("Error updating placement test:",s)}},l=c=>{const{name:s,value:x,type:N,checked:y}=c.target;b({...n,[s]:N==="checkbox"?y:x||""})};return e.jsx(e.Fragment,{children:i&&e.jsx("div",{className:"fixed inset-0 z-50  items-center justify-center text-black bg-gray-800 bg-opacity-50 scroll-auto flex flex-wrap space-x-4 sm:flex-col sm:space-x-0",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-4xl mx-auto w-full overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Update Placement Test"}),e.jsxs("button",{onClick:u,className:"text-gray-500 hover:text-gray-700",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(Z,{className:"w-5 text-dark"})]})]}),e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"testTitle",className:"block text-sm font-medium text-gray-700",children:"Test Title"}),e.jsx("input",{type:"text",name:"test_title",value:n.test_title||"",onChange:l,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{name:"description",value:n.description||"",onChange:l,rows:4,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"numberOfQuestions",className:"block text-sm font-medium text-gray-700",children:"Number of Questions"}),e.jsx("input",{type:"number",name:"number_of_questions",value:n.number_of_questions||0,onChange:l,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"startTime",className:"block text-sm font-medium text-gray-700",children:"Start Time"}),e.jsx("input",{type:"datetime-local",name:"start_time",value:n.start_time,onChange:l,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"endTime",className:"block text-sm font-medium text-gray-700",children:"End Time"}),e.jsx("input",{type:"datetime-local",name:"end_time",value:n.end_time,onChange:l,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"certificateName",className:"block text-sm font-medium text-gray-700",children:"Certificate Name"}),e.jsx("input",{type:"text",name:"certificate_name",value:n.certificate_name,onChange:l,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"show_result",checked:n.show_result,onChange:l,className:"form-checkbox text-indigo-600"}),e.jsx("label",{htmlFor:"showResult",className:"text-sm font-medium text-gray-700",children:"Show Result"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"is_Monitored",checked:n.is_Monitored,onChange:l,className:"form-checkbox text-indigo-600"}),e.jsx("label",{htmlFor:"isMonitored",className:"text-sm font-medium text-gray-700",children:"Monitored Test"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"issue_certificate",checked:n.issue_certificate,onChange:l,className:"form-checkbox text-indigo-600"}),e.jsx("label",{htmlFor:"isIssueCertificate",className:"text-sm font-medium text-gray-700",children:"Provide Certificate"})]})]}),e.jsx("button",{type:"submit",className:"w-full py-2 px-4 bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Update Test"})]})]})})})},H=()=>{const[r,i]=a.useState([]),[u,n]=a.useState(null),[b,T]=a.useState(""),[j,f]=a.useState(!1),[h,l]=a.useState(1),[c]=a.useState(10),[s,x]=a.useState(!1),[N,y]=a.useState(null),[w,_]=a.useState({show:!1,message:"",variant:""});a.useEffect(()=>((async()=>{try{const p=(await k()).sort((m,v)=>v.is_Active===m.is_Active?v.placement_test_id-m.placement_test_id:v.is_Active-m.is_Active);i(p)}catch(o){console.error("Error fetching placement tests:",o)}})(),()=>{d.dismiss()}),[]);const S=t=>{y(t),x(!0)},E=()=>{x(!1),y(null)},F=t=>{navigator.clipboard.writeText(t).then(()=>{d.success("Test link copied to clipboard")}).catch(o=>{console.error("Error copying to clipboard:",o)})},Q=async()=>{try{await D(u.placement_test_id,b),d.success("Number of questions updated successfully"),f(!1);const t=await k();i(t)}catch(t){console.error("Error updating number of questions:",t),d.error("Failed to update number of questions")}},P=async(t,o)=>{try{const p=await O(t,o);_({show:!0,message:`Link ${p?"activated":"deactivated"} successfully`,variant:"success"}),window.scrollTo({top:0,behavior:"smooth"});const m=await k();i(m)}catch(p){console.error("Error toggling link status:",p),_({show:!0,message:"Failed to update link status",variant:"danger"}),window.scrollTo({top:0,behavior:"smooth"})}},q=async t=>{try{const o=!t.is_Monitored;await U(t.placement_test_id,o);const p=r.map(m=>m.placement_test_id===t.placement_test_id?{...m,is_Monitored:o}:m);d.success("Updated status successfully"),i(p),o&&d.success("Camera Monitoring is on ")}catch(o){console.error("Error updating monitored status:",o),d.error("Failed to update monitored status")}},$=Math.ceil(r.length/c),C=h*c,L=C-c,R=r.slice(L,C);return e.jsxs(e.Fragment,{children:[w.show&&e.jsx("div",{className:`alert ${w.variant==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"} p-4 rounded-md`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:w.message}),e.jsx("button",{className:"ml-2 text-lg",onClick:()=>_({show:!1}),children:"×"})]})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white text-center my-2",children:"All Placement Tests"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto border border-gray-300 text-gray-800 dark:text-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-1 text-sm py-2 border-b",children:"ID"}),e.jsx("th",{className:"px-1 text-sm py-2 border-b",style:{width:"fit-content"},children:"Test Link"}),e.jsx("th",{className:"px-1 text-sm py-2 border-b",children:"Camera Monitoring"}),e.jsx("th",{className:"px-1 text-sm py-2 border-b",children:"Update Details"}),e.jsx("th",{className:"px-1 text-sm py-2 border-b",children:"Results"}),e.jsx("th",{className:"px-1 text-sm py-2 border-b",children:"Add Existing Questions"}),e.jsx("th",{className:"px-1 text-sm py-2 border-b",children:"Add New Questions"}),e.jsx("th",{className:"px-1 text-sm py-2 border-b",children:"Upload Questions"}),e.jsx("th",{className:"px-1 text-sm py-2 border-b",children:"Edit Questions"}),e.jsx("th",{className:"px-1 text-sm py-2 border-b",children:"Activate Link"})]})}),e.jsx("tbody",{children:R.map(t=>e.jsxs("tr",{className:t.is_Active?"bg-green-400 animate-to-top":"",children:[e.jsxs("td",{className:"px-2 py-2 border-b",children:[t.placement_test_id,t.placement_test_id===Math.max(...r.map(o=>o.placement_test_id))&&e.jsx("span",{className:"inline-block bg-blue-500 text-white text-xs rounded-full px-2 py-1 ml-2",children:"New"})]}),e.jsx("td",{className:"px-2 py-2 border-b",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"tooltip","data-tooltip":t.test_link,children:e.jsx("p",{className:"truncate max-w-xs",children:t.test_title})}),t.is_Active&&e.jsx("button",{className:"text-blue-500 ml-2",onClick:()=>F(t.test_link),children:e.jsx(V,{className:"w-4 text-black"})})]})}),e.jsx("td",{className:"px-2 py-2 border-b",children:e.jsx("input",{type:"checkbox",checked:t.is_Monitored,onChange:()=>q(t),className:"form-checkbox h-5 w-5 text-blue-500"})}),e.jsx("td",{className:"px-2 py-2 border-b",children:e.jsx("button",{onClick:()=>S(t.placement_test_id),className:"bg-blue-500 text-white py-1 px-2 rounded-md",children:"Update details"})}),e.jsx("td",{className:"px-2 py-2 border-b",children:e.jsx(g,{to:`/admin/test/get-result/${t.placement_test_id}`,className:"text-white",children:"Results"})}),e.jsx("td",{className:"px-2 py-2 border-b",children:e.jsx(g,{to:`/admin/test/add-existing-questions/${t.placement_test_id}`,className:"text-white",children:"Add Existing Questions"})}),e.jsx("td",{className:"px-2 py-2 border-b",children:e.jsx(g,{to:`/admin/test/add-new-question/${t.placement_test_id}`,className:"text-white",children:"Add New Questions"})}),e.jsx("td",{className:"px-2 py-2 border-b",children:e.jsx(g,{to:`/admin/test/upload-excel-link/${t.placement_test_id}`,className:"text-white",children:"Upload Questions"})}),e.jsx("td",{className:"px-2 py-2 border-b",children:e.jsx(g,{to:`/admin/test/edit-question/${t.placement_test_id}`,className:"text-white",children:"Edit Questions"})}),e.jsx("td",{className:"px-2 py-2 border-b",children:e.jsx("button",{className:`py-1 px-2 rounded-md text-white ${t.is_Active?"bg-green-500":"bg-red-500"}`,onClick:()=>P(t.placement_test_id,t.is_Active),children:t.is_Active?"Deactivate":"Activate"})})]},t.placement_test_id))})]})}),e.jsx(z,{placement_test_id:N,show:s,handleClose:E}),e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("button",{disabled:h===1,onClick:()=>l(h-1),className:"px-2 py-2 text-white bg-gray-500 rounded-l-md cursor-pointer",children:"Prev"}),e.jsx("button",{disabled:h===$,onClick:()=>l(h+1),className:"px-2 py-2 text-white bg-gray-500 rounded-r-md cursor-pointer",children:"Next"})]}),e.jsx("div",{className:`fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 text-black ${j?"block":"hidden"}`,children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-96 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Update Number of Questions"}),e.jsx("button",{onClick:()=>f(!1),className:"text-lg text-gray-500",children:"×"})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"numberOfQuestions",className:"block text-sm font-semibold text-gray-700",children:"Number of Questions"}),e.jsx("input",{id:"numberOfQuestions",type:"number",value:b,onChange:t=>T(t.target.value),className:"mt-2 block w-full px-2 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>f(!1),className:"px-2 py-2 bg-gray-300 rounded-md",children:"Cancel"}),e.jsx("button",{onClick:Q,className:"px-2 py-2 bg-blue-500 text-white rounded-md",children:"Save Changes"})]})]})})]})};export{H as default};
