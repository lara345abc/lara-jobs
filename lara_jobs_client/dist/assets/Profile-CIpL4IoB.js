import{r as s,j as t,L as E,b as U,c as G,E as $,g as H}from"./index-CVcFn3UJ.js";function Q({title:r,titleId:c,...m},o){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":c},m),r?s.createElement("title",{id:c},r):null,s.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.857-9.809a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z",clipRule:"evenodd"}))}const Y=s.forwardRef(Q),Z="/assets/laralogo-CP67SG2H.png",K="/assets/qr_code_whatsApp-BnZAAmg5.png",V=({email:r})=>{const[c,m]=s.useState(null),[o,j]=s.useState([]),[N,h]=s.useState(!0),[u,w]=s.useState(null),[v,C]=s.useState({}),[k,g]=s.useState(null),[z,J]=s.useState({});if(s.useEffect(()=>{(async()=>{var n;try{const p={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}},e=await U.get(`${G}/api/placement-test/test/test-results/getResultsByCandidateId`,p),{student:F,testResults:b}=e.data;m(F),j(b),C(((n=b[0])==null?void 0:n.PlacementTest)||{}),h(!1)}catch{w("Your test results will be displayed here."),h(!1)}})()},[r]),N)return t.jsx(E,{});if(u)return t.jsx("div",{className:"mt-4 mx-auto max-w-4xl",children:t.jsx("div",{className:"bg-red-100 text-red-700 p-4 rounded-lg border border-red-300",children:u})});const P=(a,n,y,p)=>{console.log("formdata ",a);const e=new $("landscape"),F=new Date().toLocaleString(),b=40,A=40;if(!a||!a.name){alert("Missing required data. Please ensure all fields are filled.");return}e.setFillColor(76,149,228),e.rect(0,0,297,210,"F"),e.setFillColor(255,173,63),e.circle(297,105,150,"F");const _=new Promise((i,x)=>{const l=new Image;l.src=Z,l.onload=()=>i(l),l.onerror=()=>x(new Error("Failed to load logo image."))}),I=new Promise((i,x)=>{const l=new Image;l.src=K,l.onload=()=>i(l),l.onerror=()=>x(new Error("Failed to load QR code image."))});Promise.all([_,I]).then(([i,x])=>{e.addImage(i,"PNG",20,15,b,A);const d=e.internal.pageSize.getWidth()/2;e.setFont("times","bold"),e.setFontSize(28),e.setTextColor(255),e.text("LARA TECHNOLOGIES",80,25),e.setFont("times","normal"),e.setFontSize(12),e.setTextColor(40,40,40),e.text("8, 100 Feet Ring Road, 2nd Stage, BTM Layout, Bengaluru, Karnataka 560076",80,32),e.text("+91 79759 38871 | ramesh@lara.co.in",80,39),e.setFont("times","bold"),e.setFontSize(28),e.setTextColor(255),e.text("CERTIFICATE OF RECOGNITION",d,60,null,null,"center"),e.setFont("times","italic"),e.setFontSize(18),e.setTextColor(255);const L=n[y].Placementtests.certificate_name||"Logical Reasoning";e.text(`in ${L}`,d,70,null,null,"center"),e.setFont("times","italic"),e.setFontSize(26),e.setTextColor(255),e.text("This certificate is hereby bestowed upon",d,80,null,null,"center"),e.setFont("times","bold"),e.setFontSize(28),e.setTextColor(0,0,0),e.text(a.name,d,95,null,null,"center"),e.setFont("times","normal"),e.setFontSize(16),e.text(`Marks Obtained: ${p.marks_obtained} out of ${p.total_marks}`,148.5,105,null,null,"center"),e.setFont("times","normal"),e.setFontSize(14),e.setTextColor(40,40,40),e.text("For successfully completing the Test conducted by Lara Technologies.",d,112,null,null,"center");const q=125,D=70,B=8,M=[{label:"Email:",value:a.email}];e.setFontSize(14),e.setFont("times","bold"),M.forEach((R,O)=>{let f=q+O*B;f>180&&(e.addPage(),f=20),e.setTextColor(40,40,40),e.text(R.label,80,f);const W=e.splitTextToSize(R.value||"N/A",100);e.text(W,80+D,f)}),e.setFont("times","italic"),e.setFontSize(10),e.setTextColor(200,200,200),e.text("Certificate generated on "+F,d,190,null,null,"center");const S=10,T=150;e.addImage(x,"PNG",S,T,40,40),e.setFont("times","italic"),e.setFontSize(12),e.setTextColor(0,0,0),e.text("Join our whatsApp channel for more updates",S+0,T+45),e.save(`${a.name}_Certificate.pdf`)}).catch(i=>{console.error(i.message),alert("Unable to load the logo or QR code. Please check the URLs.")})};return t.jsxs("div",{children:[t.jsxs("div",{className:"mt-2",children:[t.jsx("h3",{className:"text-center text-2xl font-semibold mb-4",children:"Test Results"}),o.length>0?t.jsxs("table",{className:"min-w-full table-auto border-separate border-spacing-0",children:[t.jsx("thead",{className:"bg-gray-800 text-white",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 border-b",children:"#"}),t.jsx("th",{className:"px-4 py-2 border-b",children:"Test Title"}),t.jsx("th",{className:"px-4 py-2 border-b",children:"Total Marks"}),t.jsx("th",{className:"px-4 py-2 border-b",children:"Marks Obtained"}),t.jsx("th",{className:"px-4 py-2 border-b",children:"Date"}),t.jsx("th",{className:"px-4 py-2 border-b",children:"Certificate"})]})}),t.jsx("tbody",{className:"text-black text-center",children:o.map((a,n)=>t.jsxs("tr",{className:"odd:bg-gray-100",children:[t.jsx("td",{className:"px-4 py-2 border-b",children:n+1}),t.jsx("td",{className:"px-4 py-2 border-b",children:a.Placementtests.test_title}),t.jsx("td",{className:"px-4 py-2 border-b",children:a.total_marks}),t.jsx("td",{className:"px-4 py-2 border-b",children:a.marks_obtained}),t.jsx("td",{className:"px-4 py-2 border-b",children:new Date(a.createdAt).toLocaleDateString()}),t.jsx("td",{className:"px-4 py-2 border-b",children:t.jsx("button",{onClick:()=>P(c,o,n,a),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 focus:outline-none",children:z[n]?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4 mr-2 inline-block",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 1 1 16 0 8 8 0 1 1-16 0z"})]}),"Generating..."]}):"Download Certificate"})})]},n))})]}):t.jsx("div",{className:"text-center text-lg text-blue-500 mt-4",children:"No test results available."})]}),t.jsx("div",{className:"mt-4"})]})},X="/assets/profile_pic_default-DKBqPbsW.webp",ae=()=>{const[r,c]=s.useState(null);if(s.useEffect(()=>{(async()=>{try{const g=await H();c(g)}catch(g){console.error("Error fetching details: ",g)}})()},[]),!r)return t.jsx("div",{children:t.jsx(E,{})});const{name:m,email:o,email_verified:j,phone_number:N,district:h,state:u,town:w,image_url:v}=r,C=j?t.jsx(Y,{className:"h-5 w-5 text-green-500 ml-2"}):null;return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"h-96 pt-1",children:t.jsx("div",{className:"max-w-sm mx-auto  bg-white rounded-lg overflow-hidden shadow-lg text-black",children:t.jsx("div",{className:"px-4 py-2",children:t.jsxs("div",{className:"text-center my-4",children:[t.jsx("img",{className:"h-32 w-32 rounded-full border-4 border-white dark:border-gray-800 mx-auto my-4",src:v||X,alt:"Profile picture"}),t.jsxs("div",{className:"py-2",children:[t.jsx("h3",{className:"font-bold text-2xl ",children:m||"N/A"}),t.jsxs("h6",{className:"mb-1 inline-flex items-center",children:[o||"N/A"," ",C]}),t.jsxs("div",{className:"inline-flex   items-center",children:[t.jsx("svg",{className:"h-5 w-5  mr-1",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,children:t.jsx("path",{d:"M5.64 16.36a9 9 0 1 1 12.72 0l-5.65 5.66a1 1 0 0 1-1.42 0l-5.65-5.66zm11.31-1.41a7 7 0 1 0-9.9 0L12 19.9l4.95-4.95zM12 14a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-2a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"})}),w||"N/A"," , ",h||"N/A",",",t.jsx("br",{}),u||"N/A"]}),t.jsx("div",{className:"mt-4",children:t.jsxs("p",{children:[t.jsx("strong",{children:"Phone Number: +"})," ",N||"N/A"]})})]})]})})})}),t.jsx(V,{})]})};export{ae as default};
