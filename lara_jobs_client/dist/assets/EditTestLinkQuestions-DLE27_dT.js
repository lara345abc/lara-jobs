import{r as a,i as C,j as e,h as q,k as O,e as T,f as $,b as x,c as u,V as l}from"./index-CVcFn3UJ.js";const D=()=>{const[h,b]=a.useState([]),[y,f]=a.useState(!1),[_,N]=a.useState(null),[c,d]=a.useState({question_description:"",options:[],correct_answers:[]}),{test_id:p}=C(),[j,g]=a.useState();a.useEffect(()=>{(async()=>{try{const s=await x.get(`${u}/api/placement-test/test/test-link/${p}`);g(s.data)}catch(s){s.response&&s.response.status===404?l.info("No Test details found"):l.error("Something went wrong")}})()},[p]),a.useEffect(()=>{(async()=>{try{const s=await x.post(`${u}/api/placement-test/questions/fetchQuestionsByTestId`,{placement_test_id:p});console.log("Questions ",s);const o=s.data.map(r=>({...r,options:r.QuestionOptions.map(n=>({option_id:n.option_id,option_description:n.option_description})),correct_answers:r.CorrectAnswers.map(n=>n.answer_description)}));b(o)}catch(s){console.error("Error fetching questions:",s)}})()},[p]);const v=t=>{N(t),d({question_description:t.question_description,options:t.options,correct_answers:t.correct_answers}),f(!0)},k=async t=>{try{console.log("Question ID : ",t),await x.delete(`${u}/api/placement-test/questions/delete-question/${t}`),b(h.filter(s=>s.cumulative_question_id!==t)),l.success("Question deleted successfully")}catch(s){console.error("Error deleting question:",s),l.error("Error deleting question")}},Q=()=>{d(t=>({...t,options:[...t.options,{option_id:Date.now(),option_description:""}]}))},w=(t,s)=>{const{name:o,value:r,checked:n}=t.target;o==="question_description"?d(i=>({...i,[o]:r})):o==="option_description"?d(i=>{const m=[...i.options];return m[s].option_description=r,{...i,options:m}}):o==="correct_answers"&&d(i=>({...i,correct_answers:n?[...i.correct_answers,r]:i.correct_answers.filter(m=>m!==r)}))},E=async()=>{try{const t=c.options.filter(s=>s.option_description.trim()!=="");await x.post(`${u}/api/placement-test/questions/update-question`,{..._,...c,options:t}),b(h.map(s=>s.placement_question_id===_.placement_question_id?{...s,...c,options:t}:s)),f(!1),l.success("Question updated successfully")}catch(t){console.error("Error updating question:",t),l.error("Error updating question")}};return e.jsxs("div",{className:"container mt-20",children:[e.jsx("div",{className:"container",children:j&&e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("div",{className:"my-3 w-3/5",children:e.jsxs("h5",{children:["Test Link:",e.jsx("a",{href:j.test_link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:j.test_link})]})}),e.jsx(q,{to:`/admin/test/add-new-question/${p}`,className:"w-2/5 text-center",children:e.jsx("span",{className:"btn btn-outline-primary text-white border border-blue-500 hover:bg-blue-500 hover:text-white px-4 py-2 rounded-md",children:"Add New Questions for this test link"})})]})}),e.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Edit Test Link Questions"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2 text-left",children:"#"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Question"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Options"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Correct Answers"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Actions"})]})}),e.jsx("tbody",{children:h.map((t,s)=>{const o=t.options.map(n=>n.option_description),r=t.correct_answers.some(n=>!o.includes(n));return e.jsxs("tr",{className:r?"bg-red-600 text-white":"",children:[e.jsx("td",{className:"border px-4 py-2",children:s+1}),e.jsxs("td",{className:"border px-4 py-2 overflow-x-auto text-wrap",style:{maxWidth:"60vw"},children:[e.jsx("pre",{children:t.question_description}),r&&e.jsxs("div",{className:"mt-2 flex items-center",children:[e.jsx("div",{className:"bg-yellow-400 text-black px-2 py-1 rounded-md text-sm",children:"Available options and correct options are not matching. Delete this question and add it again."}),e.jsx(O,{className:"bg-red-600 text-white ml-2 rounded-full p-2 text-xl"})]})]}),e.jsx("td",{className:"border px-4 py-2",children:t.options.map((n,i)=>e.jsx("div",{children:e.jsx("pre",{children:n.option_description})},i))}),e.jsx("td",{className:"border px-4 py-2",children:t.correct_answers.join(", ")}),e.jsxs("td",{className:"border px-4 py-2 flex space-x-2",children:[e.jsx("button",{variant:"primary",onClick:()=>v(t),className:"bg-blue-500 text-white hover:bg-blue-700 rounded-md p-2",children:e.jsx(T,{className:"w-4 "})}),e.jsx("button",{variant:"danger",onClick:()=>k(t.cumulative_question_id),className:"bg-red-500 text-white hover:bg-red-700 rounded-md p-2",children:e.jsx($,{className:"w-4 "})})]})]},s)})})]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex justify-center items-center z-50 overflow-y-auto text-black overflow-x-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl mx-4 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-4",children:[e.jsx("h5",{className:"text-lg font-semibold",children:"Edit Question"}),e.jsx("button",{onClick:()=>f(!1),className:"text-xl hover:text-red-600",children:"Ã—"})]}),e.jsx("div",{className:"p-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-4 overflow-x-auto",children:[e.jsx("label",{htmlFor:"question_description",className:"block text-sm font-medium text-gray-700",children:"Question Description"}),e.jsx("textarea",{name:"question_description",value:c.question_description,onChange:t=>w(t),rows:4,placeholder:"Enter question description",className:"mt-1 block w-full p-2 border-2 border-gray-300 rounded-md overflow-x-auto"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Options"}),c.options.map((t,s)=>e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[e.jsx("input",{type:"text",name:"option_description",value:t.option_description,onChange:o=>w(o,s),className:"block w-3/4 p-2 border-2 border-gray-300 rounded-md"}),e.jsx("input",{type:"checkbox",name:"correct_answers",value:t.option_description,checked:c.correct_answers.includes(t.option_description),onChange:o=>w(o),className:"ml-2"}),e.jsx("label",{className:"ml-2 text-sm",children:"Correct Answer"})]},t.option_id)),e.jsx("button",{type:"button",onClick:Q,className:"bg-gray-300 text-black hover:bg-gray-400 px-4 py-2 rounded-md",children:"Add Option"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:E,className:"bg-blue-500 text-white hover:bg-blue-700 px-6 py-2 rounded-md",children:"Update Question"})})]})})]})})]})};export{D as default};
