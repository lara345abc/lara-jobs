import{r as i,i as O,j as e,b as x,c as b,V as a}from"./index-CVcFn3UJ.js";function T({title:c,titleId:m,...l},p){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:p,"aria-labelledby":m},l),c?i.createElement("title",{id:m},c):null,i.createElement("path",{d:"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"}))}const q=i.forwardRef(T),E=()=>{const[c,m]=i.useState([]),[l,p]=i.useState(),[h,v]=i.useState(""),[n,d]=i.useState({question_description:"",no_of_marks_allocated:1,difficulty_level:1,options:["",""],correct_options:[]}),{test_id:u}=O(),j=async()=>{try{const t=await x.get(`${b}/api/placement-test/test/test-link/${u}`);p(t.data.data)}catch(t){console.log("Error fetching topics by test : ",t),t.response&&t.response.status===404?a.error("No Test details found"):a.error("Something went wrong")}};i.useEffect(()=>{(async()=>{try{const s=localStorage.getItem("token");if(!s)throw new Error("No token provided.");const o={headers:{Authorization:`Bearer ${s}`}},r=await x.post(`${b}/api/placement-test/topic/topics-assignedto-test`,{placement_test_id:u},{...o});r.data.topics&&m(r.data.topics)}catch(s){console.error("Error fetching subjects and topics:",s)}})(),j()},[u]);const y=t=>{v(t.target.value)},f=t=>{const{name:s,value:o}=t.target;d(r=>({...r,[s]:o}))},N=(t,s)=>{const o=[...n.options];o[t]=s,d(r=>({...r,options:o}))},_=()=>{d(t=>({...t,options:[...t.options,""]}))},k=(t,s)=>{const o=s?[...n.correct_options,t]:n.correct_options.filter(r=>r!==t);d(r=>({...r,correct_options:o}))},w=()=>{const{question_description:t,options:s,correct_options:o}=n;return h?t.trim()?s.filter(g=>g.trim()!=="").length<2?(a.error("Please provide at least two options."),!1):o.length===0?(a.error("Please select at least one correct option."),!1):!0:(a.error("Please enter a question description."),!1):(a.error("Please select a topic."),!1)},S=async t=>{if(t.preventDefault(),!!w())try{const s=localStorage.getItem("token");if(!s)throw new Error("No token provided.");const o={headers:{Authorization:`Bearer ${s}`}},r=n.options.filter(C=>C.trim()!==""),g=await x.post(`${b}/api/placement-test/questions/saveQuestionAndAddToLink`,{...n,options:r,topic_id:h,placement_test_id:u},o);console.log("Question added successfully:",g.data),a.success("Question added successfully!"),d({question_description:"",no_of_marks_allocated:1,difficulty_level:1,options:["",""],correct_options:[]})}catch(s){console.error("Error adding question:",s),a.error("Error adding question. Please try again.")}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mt-3 shadow-md rounded-lg p-6 bg-white text-black",children:[e.jsx("h3",{className:"text-center py-4 text-xl font-semibold",children:"Add Questions to Placement Test Link"}),l&&e.jsx("div",{className:"mb-4",children:e.jsxs("h5",{className:"text-lg font-medium",children:["Test Link:",e.jsx("a",{href:l.test_link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline ml-2",children:l.test_link})]})}),e.jsxs("form",{onSubmit:S,className:"w-full",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("h5",{className:"text-lg font-medium",children:["Subject Name: ",c.length>0?c[0].subject_name:"N/A"]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"topicSelect",className:"block text-sm font-medium text-gray-700",children:"Select Topic"}),e.jsxs("select",{id:"topicSelect",value:h,onChange:y,required:!0,disabled:c.length===0,className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"-- Select Topic --"}),c.map(t=>e.jsx("option",{value:t.topic_id,children:t.topic_name},t.topic_id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"marksAllocated",className:"block text-sm font-medium text-gray-700",children:"Number of Marks Allocated"}),e.jsx("input",{type:"number",id:"marksAllocated",name:"no_of_marks_allocated",value:n.no_of_marks_allocated,onChange:f,className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"difficultyLevel",className:"block text-sm font-medium text-gray-700",children:"Difficulty Level"}),e.jsx("input",{type:"number",id:"difficultyLevel",name:"difficulty_level",value:n.difficulty_level,onChange:f,className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"questionDescription",className:"block text-sm font-medium text-gray-700",children:"Question Description"}),e.jsx("textarea",{id:"questionDescription",name:"question_description",value:n.question_description,onChange:f,required:!0,rows:"4",className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-lg font-medium",children:"Options"}),n.options.map((t,s)=>e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:`option${s}`,className:"block text-sm font-medium text-gray-700",children:`Option ${s+1}`}),e.jsx("textarea",{id:`option${s}`,rows:"3",value:t,onChange:o=>N(s,o.target.value),className:"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]},s)),e.jsx("div",{className:"text-center",children:e.jsxs("span",{variant:"secondary",onClick:_,className:"mb-3 col-6 text-center  px-4 py-2 inline-block cursor-pointer bg-gray-200 rounded-md text-gray-600 hover:bg-gray-300",children:[e.jsx(q,{className:"w-5 h-5 mr-2 font-bold "}),"Add one more option"]})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-lg font-medium",children:"Correct Option(s)"}),n.options.map((t,s)=>e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",id:`correctOption${s}`,name:"correct_option",value:t,checked:n.correct_options.includes(t),onChange:o=>k(t,o.target.checked),className:"form-checkbox h-5 w-5 text-indigo-600"}),e.jsx("label",{htmlFor:`correctOption${s}`,className:"ml-2 text-sm text-gray-700",children:e.jsx("pre",{children:t||`Option ${s+1}`})})]},s))]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{variant:"primary",type:"submit",className:"col-6 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Add Question"})})]})]})})};export{E as default};
